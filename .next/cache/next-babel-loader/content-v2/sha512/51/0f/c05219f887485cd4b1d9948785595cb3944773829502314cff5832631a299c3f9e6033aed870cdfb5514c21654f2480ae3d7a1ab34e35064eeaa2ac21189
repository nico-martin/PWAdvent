{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\admin\\\\Documents\\\\Dev\\\\PWAdvent\\\\components\\\\Calendar\\\\Calendar.tsx\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { useStoreState, useActions } from 'unistore-hooks';\nimport { settingsDB } from '@store/idb';\nimport { actions } from '@store/index';\nimport CalendarDay from '@app/Calendar/CalendarDay';\nimport CalendarDayList from '@app/Calendar/CalendarDayList';\nimport CalendarHeader from '@app/Calendar/CalendarHeader';\nimport useWindowSize from '@app/hooks/useWindowSize';\nimport { DATE_END, DATE_TODAY } from '@utils/calendar';\nimport cn from '@utils/classnames';\nimport { daysOrder, daysOrderCorrect, VIEW_TYPES } from '@utils/constants';\nimport styles from './Calendar.module.css';\n\nconst Calendar = ({\n  className = ''\n}) => {\n  const [view, setView] = React.useState(null);\n  const window = useWindowSize();\n  const calendarRef = React.useRef(null);\n  const [height, setHeight] = React.useState(null);\n  const [opacity, setOpacity] = React.useState(0);\n  const {\n    setMenuOpen\n  } = useActions(actions);\n  const {\n    menuOpen\n  } = useStoreState(['menuOpen']);\n  const isCalendar = React.useMemo(() => view === VIEW_TYPES.CALENDAR, [view]);\n  React.useEffect(() => {\n    if (!DATE_TODAY.isAfter(DATE_END)) {\n      setView(VIEW_TYPES.CALENDAR);\n      return;\n    }\n\n    if (!view) {\n      settingsDB.get('view').then(v => setView(v || VIEW_TYPES.CALENDAR));\n    }\n\n    settingsDB.set('view', view);\n  }, [view]);\n  React.useEffect(() => {\n    setTimeout(() => {\n      if (calendarRef.current && window.width) {\n        if (!isCalendar) {\n          setHeight(window.height - 220);\n          return;\n        }\n\n        const isPortrait = window.height / window.width >= 1;\n        const maxHeight = window.height - 200;\n        let height = Math.round(calendarRef.current.clientWidth * (isPortrait ? 1.3 : 0.9));\n\n        if (height >= maxHeight) {\n          height = maxHeight;\n        }\n\n        setHeight(height);\n      }\n    }, 1);\n  }, [window, calendarRef, view]);\n  React.useEffect(() => {\n    height && setOpacity(1);\n  }, [height]);\n  return __jsx(\"div\", {\n    className: cn(styles.root, className),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 5\n    }\n  }, menuOpen && __jsx(\"button\", {\n    className: styles.buttonOverlay,\n    onClick: () => setMenuOpen(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }\n  }, \"close\"), __jsx(CalendarHeader, {\n    className: styles.header,\n    setView: setView,\n    view: view,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }\n  }), __jsx(\"div\", {\n    className: isCalendar ? styles.calendar : styles.list,\n    style: {\n      //height: isCalendar ? height : 'auto',\n      height,\n      opacity\n    },\n    ref: calendarRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }\n  }, (isCalendar ? daysOrder : daysOrderCorrect).map(day => __jsx(\"div\", {\n    className: `calendar__item calendar__item--${day} calendar__item--${view} `,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 11\n    }\n  }, isCalendar ? __jsx(CalendarDay, {\n    day: parseInt(day),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 15\n    }\n  }) : __jsx(CalendarDayList, {\n    day: parseInt(day),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 15\n    }\n  })))));\n};\n\nexport default Calendar;","map":{"version":3,"sources":["C:/Users/admin/Documents/Dev/PWAdvent/components/Calendar/Calendar.tsx"],"names":["React","useStoreState","useActions","settingsDB","actions","CalendarDay","CalendarDayList","CalendarHeader","useWindowSize","DATE_END","DATE_TODAY","cn","daysOrder","daysOrderCorrect","VIEW_TYPES","styles","Calendar","className","view","setView","useState","window","calendarRef","useRef","height","setHeight","opacity","setOpacity","setMenuOpen","menuOpen","isCalendar","useMemo","CALENDAR","useEffect","isAfter","get","then","v","set","setTimeout","current","width","isPortrait","maxHeight","Math","round","clientWidth","root","buttonOverlay","header","calendar","list","map","day","parseInt"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useStoreState, useActions } from 'unistore-hooks';\nimport { inspect } from 'util';\nimport { settingsDB } from '@store/idb';\nimport { actions } from '@store/index';\nimport { State } from '@store/types';\nimport CalendarDay from '@app/Calendar/CalendarDay';\nimport CalendarDayList from '@app/Calendar/CalendarDayList';\nimport CalendarHeader from '@app/Calendar/CalendarHeader';\nimport useWindowSize from '@app/hooks/useWindowSize';\nimport { DATE_END, DATE_TODAY } from '@utils/calendar';\nimport cn from '@utils/classnames';\nimport { daysOrder, daysOrderCorrect, VIEW_TYPES } from '@utils/constants';\nimport styles from './Calendar.module.css';\n\nconst Calendar = ({ className = '' }: { className?: string }) => {\n  const [view, setView] = React.useState(null);\n  const window = useWindowSize();\n  const calendarRef = React.useRef(null);\n  const [height, setHeight] = React.useState<number>(null);\n  const [opacity, setOpacity] = React.useState<number>(0);\n  const { setMenuOpen } = useActions(actions);\n  const { menuOpen } = useStoreState<State>(['menuOpen']);\n  const isCalendar = React.useMemo(() => view === VIEW_TYPES.CALENDAR, [view]);\n\n  React.useEffect(() => {\n    if (!DATE_TODAY.isAfter(DATE_END)) {\n      setView(VIEW_TYPES.CALENDAR);\n      return;\n    }\n    if (!view) {\n      settingsDB.get('view').then((v) => setView(v || VIEW_TYPES.CALENDAR));\n    }\n    settingsDB.set('view', view);\n  }, [view]);\n\n  React.useEffect(() => {\n    setTimeout(() => {\n      if (calendarRef.current && window.width) {\n        if (!isCalendar) {\n          setHeight(window.height - 220);\n          return;\n        }\n\n        const isPortrait = window.height / window.width >= 1;\n        const maxHeight = window.height - 200;\n\n        let height = Math.round(\n          calendarRef.current.clientWidth * (isPortrait ? 1.3 : 0.9)\n        );\n\n        if (height >= maxHeight) {\n          height = maxHeight;\n        }\n\n        setHeight(height);\n      }\n    }, 1);\n  }, [window, calendarRef, view]);\n\n  React.useEffect(() => {\n    height && setOpacity(1);\n  }, [height]);\n\n  return (\n    <div className={cn(styles.root, className)}>\n      {menuOpen && (\n        <button\n          className={styles.buttonOverlay}\n          onClick={() => setMenuOpen(false)}\n        >\n          close\n        </button>\n      )}\n      <CalendarHeader className={styles.header} setView={setView} view={view} />\n      <div\n        className={isCalendar ? styles.calendar : styles.list}\n        style={{\n          //height: isCalendar ? height : 'auto',\n          height,\n          opacity,\n        }}\n        ref={calendarRef}\n      >\n        {(isCalendar ? daysOrder : daysOrderCorrect).map((day) => (\n          <div\n            className={`calendar__item calendar__item--${day} calendar__item--${view} `}\n          >\n            {isCalendar ? (\n              <CalendarDay day={parseInt(day)} />\n            ) : (\n              <CalendarDayList day={parseInt(day)} />\n            )}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default Calendar;\n"]},"metadata":{},"sourceType":"module"}