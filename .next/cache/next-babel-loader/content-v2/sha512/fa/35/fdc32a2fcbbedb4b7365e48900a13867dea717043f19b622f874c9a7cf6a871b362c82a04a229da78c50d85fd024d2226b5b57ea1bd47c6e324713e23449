{"ast":null,"code":"import _slicedToArray from \"C:/Users/admin/Documents/Dev/PWAdvent/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\admin\\\\Documents\\\\Dev\\\\PWAdvent\\\\components\\\\Calendar\\\\Calendar.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { useStoreState, useActions } from 'unistore-hooks';\nimport CalendarDay from '@comps/Calendar/CalendarDay';\nimport { settingsDB } from '@store/idb';\nimport { actions } from '@store/index';\nimport CalendarDayList from '@comps/Calendar/CalendarDayList';\nimport CalendarHeader from '@comps/Calendar/CalendarHeader';\nimport useWindowSize from '@comps/hooks/useWindowSize';\nimport { DATE_END, DATE_TODAY } from '@utils/calendar';\nimport cn from '@utils/classnames';\nimport { daysOrder, daysOrderCorrect, VIEW_TYPES } from '@utils/constants';\nimport styles from './Calendar.module.css';\n\nvar Calendar = function Calendar(_ref) {\n  _s();\n\n  var _ref$className = _ref.className,\n      className = _ref$className === void 0 ? '' : _ref$className;\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      view = _React$useState2[0],\n      setView = _React$useState2[1];\n\n  var window = useWindowSize();\n  var calendarRef = React.useRef(null);\n\n  var _React$useState3 = React.useState(null),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      height = _React$useState4[0],\n      setHeight = _React$useState4[1];\n\n  var _React$useState5 = React.useState(0),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      opacity = _React$useState6[0],\n      setOpacity = _React$useState6[1];\n\n  var _useActions = useActions(actions),\n      setMenuOpen = _useActions.setMenuOpen;\n\n  var _useStoreState = useStoreState(['menuOpen']),\n      menuOpen = _useStoreState.menuOpen;\n\n  var isCalendar = React.useMemo(function () {\n    return view === VIEW_TYPES.CALENDAR;\n  }, [view]);\n  React.useEffect(function () {\n    if (!DATE_TODAY.isAfter(DATE_END)) {\n      setView(VIEW_TYPES.CALENDAR);\n      return;\n    }\n\n    if (!view) {\n      settingsDB.get('view').then(function (v) {\n        return setView(v || VIEW_TYPES.CALENDAR);\n      });\n    }\n\n    settingsDB.set('view', view);\n  }, [view]);\n  React.useEffect(function () {\n    setTimeout(function () {\n      if (calendarRef.current && window.width) {\n        if (!isCalendar) {\n          setHeight(window.height - 220);\n          return;\n        }\n\n        var isPortrait = window.height / window.width >= 1;\n        var maxHeight = window.height - 200;\n\n        var _height = Math.round(calendarRef.current.clientWidth * (isPortrait ? 1.3 : 0.9));\n\n        if (_height >= maxHeight) {\n          _height = maxHeight;\n        }\n\n        setHeight(_height);\n      }\n    }, 1);\n  }, [window, calendarRef, view]);\n  React.useEffect(function () {\n    height && setOpacity(1);\n  }, [height]);\n  return __jsx(\"div\", {\n    className: cn(styles.root, className),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 5\n    }\n  }, menuOpen && __jsx(\"button\", {\n    className: styles.buttonOverlay,\n    onClick: function onClick() {\n      return setMenuOpen(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }\n  }, \"close\"), __jsx(CalendarHeader, {\n    className: styles.header,\n    setView: setView,\n    view: view,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }\n  }), __jsx(\"div\", {\n    className: isCalendar ? styles.calendar : styles.list,\n    style: {\n      //height: isCalendar ? height : 'auto',\n      height: height,\n      opacity: opacity\n    },\n    ref: calendarRef,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }\n  }, (isCalendar ? daysOrder : daysOrderCorrect).map(function (day) {\n    return __jsx(\"div\", {\n      className: cn(styles.item, styles[\"item--\".concat(day)], styles[\"item--\".concat(view)]),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 11\n      }\n    }, isCalendar ? __jsx(CalendarDay, {\n      day: parseInt(day),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 15\n      }\n    }) : __jsx(CalendarDayList, {\n      day: parseInt(day),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 15\n      }\n    }));\n  })));\n};\n\n_s(Calendar, \"tXOTYZemcLBz3oIdGRv63UfmLIE=\", false, function () {\n  return [useWindowSize, useActions, useStoreState];\n});\n\n_c = Calendar;\nexport default Calendar;\n\nvar _c;\n\n$RefreshReg$(_c, \"Calendar\");","map":{"version":3,"sources":["C:/Users/admin/Documents/Dev/PWAdvent/components/Calendar/Calendar.tsx"],"names":["React","useStoreState","useActions","CalendarDay","settingsDB","actions","CalendarDayList","CalendarHeader","useWindowSize","DATE_END","DATE_TODAY","cn","daysOrder","daysOrderCorrect","VIEW_TYPES","styles","Calendar","className","useState","view","setView","window","calendarRef","useRef","height","setHeight","opacity","setOpacity","setMenuOpen","menuOpen","isCalendar","useMemo","CALENDAR","useEffect","isAfter","get","then","v","set","setTimeout","current","width","isPortrait","maxHeight","Math","round","clientWidth","root","buttonOverlay","header","calendar","list","map","day","item","parseInt"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useStoreState, useActions } from 'unistore-hooks';\nimport { inspect } from 'util';\nimport CalendarDay from '@comps/Calendar/CalendarDay';\nimport { settingsDB } from '@store/idb';\nimport { actions } from '@store/index';\nimport { State } from '@store/types';\nimport CalendarDayList from '@comps/Calendar/CalendarDayList';\nimport CalendarHeader from '@comps/Calendar/CalendarHeader';\nimport useWindowSize from '@comps/hooks/useWindowSize';\nimport { DATE_END, DATE_TODAY } from '@utils/calendar';\nimport cn from '@utils/classnames';\nimport { daysOrder, daysOrderCorrect, VIEW_TYPES } from '@utils/constants';\nimport styles from './Calendar.module.css';\n\nconst Calendar = ({ className = '' }: { className?: string }) => {\n  const [view, setView] = React.useState(null);\n  const window = useWindowSize();\n  const calendarRef = React.useRef(null);\n  const [height, setHeight] = React.useState<number>(null);\n  const [opacity, setOpacity] = React.useState<number>(0);\n  const { setMenuOpen } = useActions(actions);\n  const { menuOpen } = useStoreState<State>(['menuOpen']);\n  const isCalendar = React.useMemo(() => view === VIEW_TYPES.CALENDAR, [view]);\n\n  React.useEffect(() => {\n    if (!DATE_TODAY.isAfter(DATE_END)) {\n      setView(VIEW_TYPES.CALENDAR);\n      return;\n    }\n    if (!view) {\n      settingsDB.get('view').then((v) => setView(v || VIEW_TYPES.CALENDAR));\n    }\n    settingsDB.set('view', view);\n  }, [view]);\n\n  React.useEffect(() => {\n    setTimeout(() => {\n      if (calendarRef.current && window.width) {\n        if (!isCalendar) {\n          setHeight(window.height - 220);\n          return;\n        }\n\n        const isPortrait = window.height / window.width >= 1;\n        const maxHeight = window.height - 200;\n\n        let height = Math.round(\n          calendarRef.current.clientWidth * (isPortrait ? 1.3 : 0.9)\n        );\n\n        if (height >= maxHeight) {\n          height = maxHeight;\n        }\n\n        setHeight(height);\n      }\n    }, 1);\n  }, [window, calendarRef, view]);\n\n  React.useEffect(() => {\n    height && setOpacity(1);\n  }, [height]);\n\n  return (\n    <div className={cn(styles.root, className)}>\n      {menuOpen && (\n        <button\n          className={styles.buttonOverlay}\n          onClick={() => setMenuOpen(false)}\n        >\n          close\n        </button>\n      )}\n      <CalendarHeader className={styles.header} setView={setView} view={view} />\n      <div\n        className={isCalendar ? styles.calendar : styles.list}\n        style={{\n          //height: isCalendar ? height : 'auto',\n          height,\n          opacity,\n        }}\n        ref={calendarRef}\n      >\n        {(isCalendar ? daysOrder : daysOrderCorrect).map((day) => (\n          <div\n            className={cn(\n              styles.item,\n              styles[`item--${day}`],\n              styles[`item--${view}`]\n            )}\n          >\n            {isCalendar ? (\n              <CalendarDay day={parseInt(day)} />\n            ) : (\n              <CalendarDayList day={parseInt(day)} />\n            )}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default Calendar;\n"]},"metadata":{},"sourceType":"module"}